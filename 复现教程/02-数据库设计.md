# 第二步：数据库设计

## 1. 创建数据库

打开命令行，登录MySQL：
```bash
mysql -u root -p
```
输入密码后，执行：
```sql
CREATE DATABASE student_management CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
USE student_management;
```

## 2. 创建数据表

### 2.1 用户表（users）
存储管理员账号信息
```sql
CREATE TABLE users (
  id INT PRIMARY KEY AUTO_INCREMENT,
  email VARCHAR(100) UNIQUE NOT NULL,
  password VARCHAR(255) NOT NULL,
  real_name VARCHAR(50),
  phone VARCHAR(20),
  role VARCHAR(20) DEFAULT 'admin',
  avatar_url TEXT,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### 2.2 学生表（students）
存储学生基本信息
```sql
CREATE TABLE students (
  id INT PRIMARY KEY AUTO_INCREMENT,
  student_no VARCHAR(20) UNIQUE NOT NULL,
  real_name VARCHAR(50) NOT NULL,
  gender VARCHAR(10),
  birth_date DATE,
  grade VARCHAR(10) NOT NULL,
  class VARCHAR(50) NOT NULL,
  phone VARCHAR(20),
  email VARCHAR(100),
  address TEXT,
  emergency_contact VARCHAR(20),
  status TINYINT DEFAULT 1,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### 2.3 课程表（courses）
```sql
CREATE TABLE courses (
  id INT PRIMARY KEY AUTO_INCREMENT,
  course_no VARCHAR(20) UNIQUE NOT NULL,
  course_name VARCHAR(100) NOT NULL,
  credit DECIMAL(3,1),
  teacher_name VARCHAR(50),
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### 2.4 选课表（student_courses）
```sql
CREATE TABLE student_courses (
  id INT PRIMARY KEY AUTO_INCREMENT,
  student_id INT NOT NULL,
  course_id INT NOT NULL,
  status VARCHAR(20) DEFAULT '已选',
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (student_id) REFERENCES students(id),
  FOREIGN KEY (course_id) REFERENCES courses(id)
);
```

### 2.5 成绩表（scores）
```sql
CREATE TABLE scores (
  id INT PRIMARY KEY AUTO_INCREMENT,
  student_id INT NOT NULL,
  student_no VARCHAR(20),
  student_name VARCHAR(50),
  grade VARCHAR(10),
  class VARCHAR(50),
  course_id INT NOT NULL,
  course_name VARCHAR(100),
  usual_score DECIMAL(5,2),
  final_score DECIMAL(5,2),
  total_score DECIMAL(5,2),
  teacher_id INT,
  teacher_name VARCHAR(50),
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

### 2.6 考勤表（attendance）
```sql
CREATE TABLE attendance (
  id INT PRIMARY KEY AUTO_INCREMENT,
  student_id INT NOT NULL,
  student_no VARCHAR(20),
  student_name VARCHAR(50),
  grade VARCHAR(10),
  class VARCHAR(50),
  course_id INT NOT NULL,
  course_name VARCHAR(100),
  attendance_date DATE NOT NULL,
  type VARCHAR(20) NOT NULL,
  reason TEXT,
  teacher_id INT,
  teacher_name VARCHAR(50),
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### 2.7 通知表（notifications）
```sql
CREATE TABLE notifications (
  id INT PRIMARY KEY AUTO_INCREMENT,
  title VARCHAR(200) NOT NULL,
  content TEXT NOT NULL,
  type VARCHAR(50),
  sender_id INT,
  sender_name VARCHAR(50),
  receiver_role VARCHAR(20),
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

## 3. 插入测试数据

### 3.1 创建管理员账号
```sql
INSERT INTO users (email, password, real_name, role) 
VALUES ('admin@example.com', '$2a$10$encrypted_password', '管理员', 'admin');
```

### 3.2 添加测试学生
```sql
INSERT INTO students (student_no, real_name, gender, birth_date, grade, class, phone, email) 
VALUES 
('2024001', '张三', '男', '2004-06-20', '2024', '计算机1班', '13800000001', 'zhangsan@qq.com'),
('2024002', '李四', '女', '2004-09-08', '2024', '计算机1班', '13800000002', 'lisi@qq.com');
```

### 3.3 添加测试课程
```sql
INSERT INTO courses (course_no, course_name, credit, teacher_name) 
VALUES 
('CS101', '数据结构', 4.0, '王老师'),
('CS102', '算法设计', 3.5, '李老师');
```

## 4. 验证数据库

```sql
SHOW TABLES;
SELECT * FROM users;
SELECT * FROM students;
SELECT * FROM courses;
```

## 下一步

数据库创建完成后，继续阅读 `03-后端开发.md`
